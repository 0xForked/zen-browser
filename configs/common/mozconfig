
# Browser branding
ac_add_options --enable-update-channel=release
ac_add_options --without-wasm-sandboxed-libraries

ac_add_options --with-branding=${brandingDir}

ac_add_options --with-app-name=${binName}
export MOZ_USER_DIR="${name}"
export MOZ_APP_VENDOR="${vendor}"
export MOZ_APP_BASENAME=Zen
export MOZ_APP_PROFILE=${binName}
export MOZ_APP_DISPLAYNAME="${name}"
export MOZ_BRANDING_DIRECTORY=${brandingDir}
export MOZ_OFFICIAL_BRANDING_DIRECTORY=${brandingDir}
export MOZ_MACBUNDLE_ID=${appId}
export MOZ_DISTRIBUTION_ID=${appId}

# Uncomment if builds are too resource hungry
# mk_add_options MOZ_MAKE_FLAGS="-j4"
#ac_add_options --enable-linker=gold

# Misc
export MOZ_STUB_INSTALLER=1
export MOZ_INCLUDE_SOURCE_INFO=1
export MOZ_SOURCE_REPO=https://github.com/zen-browser/desktop
export MOZ_SOURCE_CHANGESET=${changeset}

ac_add_options --enable-bootstrap

ac_add_options --enable-application=browser

if test "$ZEN_RELEASE"; then
  ac_add_options --enable-hardening
  ac_add_options --enable-rust-simd
  ac_add_options --enable-release
  ac_add_options --enable-optimize
  ac_add_options --with-ccache=sccache
  ac_add_options --disable-debug
  ac_add_options --disable-debug-js-modules

  ac_add_options --disable-crashreporter
  ac_add_options --disable-dmd
  ac_add_options --disable-geckodriver
  ac_add_options --disable-parental-controls
  ac_add_options --disable-profiling
  ac_add_options --disable-tests

  ac_add_options --enable-lto

  mk_add_options MOZILLA_OFFICIAL=1

  MOZILLA_OFFICIAL=1
  export MOZILLA_OFFICIAL=1
  mk_add_options MOZ_OPTIMIZE=1
  MOZ_OPTIMIZE=1
  export MOZ_OPTIMIZE=1
  export STRIP_FLAGS="--strip-debug --strip-unneeded"

  export OPT_LEVEL="3"
  ac_add_options OPT_LEVEL="3"
  export RUSTC_OPT_LEVEL="3"
  ac_add_options RUSTC_OPT_LEVEL="3"

  export MOZ_LTO=1
  ac_add_options MOZ_LTO=1
  export MOZ_PGO=1
  ac_add_options MOZ_PGO=1
fi

ac_add_options --enable-unverified-updates
ac_add_options --enable-updater

ac_add_options --without-wasm-sandboxed-libraries

export MOZ_REQUIRE_SIGNING=
export MOZ_TELEMETRY_REPORTING=

if test "$ZEN_CROSS_COMPILING"; then
  ac_add_options --target=x86_64-pc-linux-gnu
fi

# ALWAYS MANTAIN ONE LINE BREAK AT THE END OF THIS FILE

