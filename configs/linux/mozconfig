ac_add_options --enable-wasm-avx

# not when cross compiling
if ! test "$ZEN_CROSS_COMPILING"; then
    if test "$ZEN_RELEASE"; then
        ac_add_options --enable-optimize="-march=x86-64 -msse3 -mtune=haswell -O3 -w"
        ac_add_options --enable-release
        ac_add_options --enable-rust-simd
        ac_add_options --disable-elf-hack
        ac_add_options RUSTC_OPT_LEVEL=3
        export MOZILLA_OFFICIAL=1
        export RUSTFLAGS="$RUSTFLAGS -Ctarget-cpu=x86-64"
    fi

    if test -d "$HOME/.mozbuild/clang/bin"; then
        export CC="$HOME"/.mozbuild/clang/bin/clang
        export CXX="$HOME"/.mozbuild/clang/bin/clang++
    else
        export CC=clang
        export CXX=clang++
    fi

    ac_add_options --enable-linker=lld
    ac_add_options --enable-strip
    export STRIP_FLAGS="--strip-debug --strip-unneeded"
fi

# Disable telemetry and tracking
mk_add_options MOZ_TELEMETRY_REPORTING=
mk_add_options MOZ_DATA_REPORTING=
